<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sản phẩm - Make My Home (Demo)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<header class="main-header">
    <div class="logo">
        <a href="index.html">MAKE MY HOME</a>
    </div>
    <nav class="main-nav">
        <ul>
            <li><a href="index.html">TRANG CHỦ</a></li>
            <li><a href="gioi-thieu.html">GIỚI THIỆU</a></li>
            <li><a href="san-pham.html">SẢN PHẨM</a></li>
            <li><a href="tin-tuc.html">TIN TỨC</a></li>
            <li><a href="lien-he.html">LIÊN HỆ</a></li>
        </ul>
    </nav>
    <div class="header-icons">
        <a href="gio-hang.html" class="cart-icon">
            <i class="fas fa-shopping-bag"></i>
            (<span id="cart-count">0</span>)
        </a>
    </div>
</header>

<main>
    <section class="page-title-banner">
        <h1>SẢN PHẨM</h1>
    </section>

    <section class="module-section" style="padding-top: 1rem; padding-bottom: 0;">
        <div class="category-filters">
            <button class="filter-btn active" onclick="filterProducts(this, 'all')" data-filter="all">Tất cả</button>
            <button class="filter-btn" onclick="filterProducts(this, 'sofa')" data-filter="sofa">Sofa</button>
            <button class="filter-btn" onclick="filterProducts(this, 'ban')" data-filter="ban">Bàn</button>
            <button class="filter-btn" onclick="filterProducts(this, 'ghe')" data-filter="ghe">Ghế</button>
            <button class="filter-btn" onclick="filterProducts(this, 'giuong')" data-filter="giuong">Giường</button>
        </div>
    </section>

    <section class="module-section" style="padding-top: 2rem;">
        <div class="product-grid" id="product-list">
        </div>
    </section>
</main>

<footer class="main-footer">
    <div class="footer-grid">
        <div class="footer-column">
            <h4>VỀ CHÚNG TÔI</h4>
            <a href="gioi-thieu.html">Giới thiệu</a>
            <a href="#">Hệ thống cửa hàng</a>
            <a href="lien-he.html">Liên hệ</a>
        </div>
        <div class="footer-column">
            <h4>HỖ TRỢ KHÁCH HÀNG</h4>
            <a href="#">Chính sách đổi trả</a>
            <a href="#">Chính sách bảo hành</a>
            <a href="#">Hướng dẫn mua hàng</a>
        </div>
        <div class="footer-column">
            <h4>LIÊN HỆ</h4>
            <p><i class="fas fa-map-marker-alt"></i> 123, Đường ABC, Q.1, TP. HCM</p>
            <p><i class="fas fa-phone"></i> 1900 1234</p>
            <p><i class="fas fa-envelope"></i> support@makemyhome.vn</p>
        </div>
        <div class="footer-column">
            <h4>THEO DÕI CHÚNG TÔI</h4>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-pinterest-p"></i></a>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <p>© 2025 Make My Home (Demo). All rights reserved.</p>
    </div>
</footer>

<script src="js/main.js"></script>

<script src="js/data.js"></script>

<script>
    const productListContainer = document.getElementById('product-list');

    // Hàm TẠO HTML cho 1 sản phẩm (Đã có từ lần trước)
    function createProductHTML(product) {
        return `
                <div class="product-card" data-category="${product.category}">
                    <a href="chi-tiet-san-pham.html?id=${product.id}">
                        <img src="${product.img}" alt="${product.name}">
                    </a>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p class="product-summary">${product.summary}</p>
                        <p class="price">${formatCurrency(product.price)}</p>
                    </div>
                </div>
            `;
    }

    // Hàm TẢI TẤT CẢ SẢN PHẨM lên trang
    function loadProducts() {
        productData.forEach(product => {
            productListContainer.innerHTML += createProductHTML(product);
        });
    }

    // Hàm LỌC SẢN PHẨM (ĐÃ CẬP NHẬT)
    // 'clickedButton' là 'this' mà chúng ta truyền vào
    function filterProducts(clickedButton, category) {
        const products = document.querySelectorAll('#product-list .product-card');
        const filterButtons = document.querySelectorAll('.category-filters .filter-btn');

        // 1. Lọc danh sách sản phẩm
        products.forEach(product => {
            if (category === 'all' || product.dataset.category === category) {
                product.style.display = 'block';
            } else {
                product.style.display = 'none';
            }
        });

        // 2. Cập nhật trạng thái 'active' cho nút
        filterButtons.forEach(btn => btn.classList.remove('active'));

        if (clickedButton) {
            // Nếu người dùng nhấn nút
            clickedButton.classList.add('active');
        } else {
            // Nếu trang tự động lọc (từ URL)
            // Tìm nút có data-filter khớp với category
            const activeButton = document.querySelector(`.filter-btn[data-filter="${category}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }
    }

    // Tự động tải sản phẩm VÀ KIỂM TRA URL khi trang được mở
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Luôn tải TẤT CẢ sản phẩm (ẩn/hiện bằng CSS sau)
        loadProducts();

        // 2. (MỚI) Kiểm tra xem có category trên URL không
        const params = new URLSearchParams(window.location.search);
        const categoryFromURL = params.get('category');

        if (categoryFromURL) {
            // 3. Nếu có, tự động gọi hàm lọc
            // Truyền 'null' vì không có nút nào được nhấn
            filterProducts(null, categoryFromURL);
        }
        // Nếu không có, trang sẽ hiển thị 'Tất cả' như mặc định
    });
</script>
</body>
</html>